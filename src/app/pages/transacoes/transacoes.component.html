<!-- transacoes.component.html -->

<div class="screen">
  <app-siderbar-menu></app-siderbar-menu>
  <div class="container">
    <div class="button_container">
      <button (click)="selectTab('tudo')" [class.active]="selectedTab === 'tudo'">Tudo</button>
      <button (click)="selectTab('entrada')" [class.active]="selectedTab === 'entrada'">Entrada</button>
      <button (click)="selectTab('saida')" [class.active]="selectedTab === 'saida'">Saída</button>
    </div>

    <ul class="transacao_container">
      <div class="transacao_header">
        <strong>Data</strong>
        <strong>Método de Pagamento</strong>
        <strong>Valor</strong>
        <strong>Tipo</strong>
      </div>
      <li *ngFor="let transacao of paginatedTransacoes" class="transacao_data">
        <p>{{ transacao.data | date:'dd/MM/yyyy' }}</p>
        <p> {{ transacao.metodoPagamento }}</p>
        <p>{{ transacao.valor | currency:'BRL' }}</p>
        <p>{{ transacao.tipo }}</p>
      </li>
    </ul>
    <button (click)="openModal()" class="nova_transacao">Nova Transação</button>
    <div class="pagination">
      <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">Anterior</button>
      <span>Página {{ currentPage }} de {{ totalPages }}</span>
      <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages">Próxima</button>
    </div>

    <div *ngIf="showModal" class="modal">
      <div class="modal-content">
        <h2>Adicionar Nova Transação</h2>

        <label for="tipo">Tipo de Transação:</label>
        <select id="tipo" [(ngModel)]="novaTransacao.tipo">
          <option value="entrada">Entrada</option>
          <option value="saida">Saída</option>
        </select>

        <label for="metodoPagamento">Método de Pagamento:</label>
        <select id="metodoPagamento" [(ngModel)]="novaTransacao.metodoPagamento">
          <option value="Dinheiro">Dinheiro</option>
          <option value="PIX">PIX</option>
          <option value="Cartão de Crédito">Cartão de Crédito</option>
        </select>

        <label for="data">Data:</label>
        <input type="date" id="data" [(ngModel)]="novaTransacao.data">

        <!-- Mostrar o campo de serviços apenas se o tipo for 'entrada' -->
        <div *ngIf="novaTransacao.tipo === 'entrada'">
          <h3>Serviços Realizados</h3>

          <div *ngFor="let servico of novaTransacao.servicosRealizados">
            <p><strong>Nome:</strong> {{ servico.nome }} | <strong>Descrição:</strong> {{ servico.descricao }} |
              <strong>Preço:</strong> {{ servico.valor | currency:'BRL' }}
            </p>
          </div>

          <h4>Adicionar Serviço</h4>
          <label for="nomeServico">Nome:</label>
          <select id="nomeServico" [(ngModel)]="novoServico.nome">
            <option *ngFor="let servico of servicos" [value]="servico.nome">{{ servico.nome }}</option>
          </select>

          <label for="descricaoServico">Descrição:</label>
          <input type="text" id="descricaoServico" [(ngModel)]="novoServico.descricao">

          <label for="precoServico">Preço:</label>
          <input type="number" id="precoServico" [(ngModel)]="novoServico.valor">

          <button (click)="addServico()">Adicionar Serviço</button>
        </div>

        <label for="valor">Valor Total:</label>
        <input type="number" id="valor" [(ngModel)]="novaTransacao.valor" readonly>

        <button (click)="addTransacao()">Adicionar</button>
        <button (click)="closeModal()">Cancelar</button>
      </div>
    </div>
  </div>
</div>